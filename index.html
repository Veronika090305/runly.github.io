<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUNLI - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –≥–∞—Ä–º–æ–Ω–∏–∏ –≤ –∑–¥–æ—Ä–æ–≤—å–µ, —Ñ–∏–Ω–∞–Ω—Å–∞—Ö –∏ –±—ã—Ç—É</title>
    <meta name="description" content="RUNLI (–†—É–Ω–ª–∏) - –µ–¥–∏–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤–º–µ—Å—Ç–æ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è, —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –±—ã—Ç–∞. –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏.">
    <meta name="keywords" content="—Ä—É–Ω–ª–∏, runli, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –∑–¥–æ—Ä–æ–≤—å–µ, —Ñ–∏–Ω–∞–Ω—Å—ã, –±—ã—Ç, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –≥–∞—Ä–º–æ–Ω–∏—è, —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–µ–≤—É—à–µ–∫">
    
    <!-- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —à—Ä–∏—Ñ—Ç–æ–≤ -->
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;500;600&family=Inter:wght@300;400;500;600&family=Lora:wght@400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
    
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = 'https://lyqedngejapolcffscyk.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5cWVkbmdlamFwb2xjZmZzY3lrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI5NzYxOTAsImV4cCI6MjA3ODU1MjE5MH0.xdRoqew8xSAmDbDtryMQBmu7vj9FBj_AQDD5cCJl-_g';
        window.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    </script>
    
    <!-- –°–∏—Å—Ç–µ–º–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã-–∑–∞–≥–ª—É—à–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è FOIT -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .raleway-heading {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 600;
        }
        .inter-white, .inter-text {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ */
        .avatar-upload {
            text-align: center;
            margin: 15px 0;
        }

        .avatar-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--powder-petal);
            border: 2px dashed var(--cherry-blossom);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .avatar-preview:hover {
            border-color: var(--ash-grey);
            transform: scale(1.05);
        }

        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .avatar-preview span {
            font-size: 2em;
            color: var(--cherry-blossom);
        }
    </style>
</head>
<body>
    <header>
        <h1>RUNLI</h1>
        <nav>
            <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a> |
            <a href="about.html">–ù–∞—à–∞ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è</a> |
            <a href="telegram.html">–ú—ã –≤ Telegram</a>
        </nav>
    </header>

    <main>
        <!-- –ì–ª–∞–≤–Ω–∞—è —Å–µ–∫—Ü–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º –∏ —Ñ–æ—Ä–º–æ–π -->
        <section class="hero-section">
<div class="hero-content">
    <h2 class="raleway-heading">–õ–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –≥–¥–µ –∑–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π</h2>
    <p class="inter-white">
        –ë—ã–≤–∞–ª–æ —É –≤–∞—Å —Ç–∞–∫–æ–µ?<br>
        –ù–∞—á–∏–Ω–∞–µ—à—å –≤–µ—Å—Ç–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–∏–∫, –∞ —á–µ—Ä–µ–∑ –º–µ—Å—è—Ü –Ω–∞—Ö–æ–¥–∏—à—å –µ–≥–æ —Ç–æ–ª—å–∫–æ —Å –æ–¥–Ω–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π.<br>
        –ó–∞–ø–∏—Å—ã–≤–∞–µ—à—å –∏–¥–µ–∏ –≤ –∑–∞–º–µ—Ç–∫–∏ –∏ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è –∫ –Ω–∏–º.<br>
        –ê —Å–∫–æ–ª—å–∫–æ —Ü–µ–Ω–Ω–æ–≥–æ —Ç–∞–∫ –∏ –æ—Å—Ç–∞–ª–æ—Å—å ¬´–Ω–∞ –ø–æ—Ç–æ–º¬ª: —Ç–∞ —Å—Ç–∞—Ç—å—è, —Ç–æ—Ç —Ä–µ—Ü–µ–ø—Ç, —Ç–æ—Ç –∫—É—Ä—Å...
    </p>

    <p class="inter-white">
        RUNLI - —ç—Ç–æ –ø—Ä–æ–¥—É–º–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞, –≥–¥–µ –∫–∞–∂–¥–∞—è –¥–µ—Ç–∞–ª—å —Å–ª—É–∂–∏—Ç –æ–¥–Ω–æ–π —Ü–µ–ª–∏ -<br>
        –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –≤–∞—à–µ –≤—Ä–µ–º—è, —ç–Ω–µ—Ä–≥–∏—é –∏ –º—ã—Å–ª–∏.
    </p>

    <p class="inter-white">
        –í–∞—à–∞ –≥–∞—Ä–º–æ–Ω–∏—è - –Ω–∞—à –≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ–µ–∫—Ç!
    </p>
</div>

            <!-- –ë–ª–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
            <div class="auth-section">
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">–í—Ö–æ–¥</button>
                    <button class="auth-tab" data-tab="signup">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>

                <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
                <div id="login-form" class="auth-form active">
                    <form id="signin-form">
                        <input type="email" id="signin-email" placeholder="Email" required>
                        <input type="password" id="signin-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        <div class="auth-links">
                            <button type="button" id="forgot-password" class="link white-link">–ù–µ –ø–æ–º–Ω—é –ø–∞—Ä–æ–ª—å</button>
                        </div>
                        <button type="submit" class="auth-button">–í–æ–π—Ç–∏</button>
                    </form>
                    <div id="signin-msg" class="notice" style="display:none"></div>
                </div>

                <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
                <div id="signup-form" class="auth-form">
                    <form id="register-form">
                        <input type="email" id="register-email" placeholder="Email" required>
                        <input type="password" id="register-password" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)" required>
                        
<div class="form-row">
    <div class="form-group">
        <label>–í–∞—à–µ –∏–º—è</label>
        <input type="text" id="register-name" placeholder="–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?" required>
    </div>
    <div class="form-group">
        <label>–í–æ–∑—Ä–∞—Å—Ç</label>
        <input type="number" id="register-age" placeholder="–°–∫–æ–ª—å–∫–æ –≤–∞–º –ª–µ—Ç?" min="0" max="150">
    </div>
</div>

<!-- –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞ -->
<div class="form-group">
    <label>–ê–≤–∞—Ç–∞—Ä (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)</label>
    <input type="file" id="register-avatar" accept="image/*" style="display: none;">
    <div class="avatar-upload">
        <div class="avatar-preview" id="avatar-preview">
            <span>üì∑</span>
        </div>
        <button type="button" class="button" onclick="document.getElementById('register-avatar').click()" style="margin-top: 10px;">
            –í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ
        </button>
    </div>
</div>

                        <div class="form-group">
                            <label>–í–∞—à–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ):</label>
                            <div class="checkbox-grid">
                                <div class="checkbox-card">
                                    <input type="checkbox" id="activity-school" name="activity" value="school">
                                    <label for="activity-school" class="checkbox-label">
                                        <span class="checkbox-icon">üè´</span>
                                        <span class="checkbox-text">–®–∫–æ–ª–∞</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="activity-student" name="activity" value="student">
                                    <label for="activity-student" class="checkbox-label">
                                        <span class="checkbox-icon">üéì</span>
                                        <span class="checkbox-text">–í—É–∑ –∏–ª–∏ –°–ü–û</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="activity-employed" name="activity" value="employed">
                                    <label for="activity-employed" class="checkbox-label">
                                        <span class="checkbox-icon">üíº</span>
                                        <span class="checkbox-text">–†–∞–±–æ—Ç–∞</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="activity-unemployed" name="activity" value="unemployed">
                                    <label for="activity-unemployed" class="checkbox-label">
                                        <span class="checkbox-icon">üå±</span>
                                        <span class="checkbox-text">–î–æ–º –∏ —Å–µ–º—å—è</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="activity-entrepreneur" name="activity" value="entrepreneur">
                                    <label for="activity-entrepreneur" class="checkbox-label">
                                        <span class="checkbox-icon">üöÄ</span>
                                        <span class="checkbox-text">–ë–∏–∑–Ω–µ—Å</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="activity-other" name="activity" value="other">
                                    <label for="activity-other" class="checkbox-label">
                                        <span class="checkbox-icon">‚ú®</span>
                                        <span class="checkbox-text">–î—Ä—É–≥–æ–µ</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>–¶–µ–ª–∏ –Ω–∞ RUNLI (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ)</label>
                            <div class="checkbox-grid">
                                <div class="checkbox-card">
                                    <input type="checkbox" id="goal-finance" name="goals" value="finance">
                                    <label for="goal-finance" class="checkbox-label">
                                        <span class="checkbox-icon">üí∞</span>
                                        <span class="checkbox-text">–§–∏–Ω–∞–Ω—Å—ã</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="goal-career" name="goals" value="career">
                                    <label for="goal-career" class="checkbox-label">
                                        <span class="checkbox-icon">üéØ</span>
                                        <span class="checkbox-text">–ö–∞—Ä—å–µ—Ä–∞</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="goal-study" name="goals" value="study">
                                    <label for="goal-study" class="checkbox-label">
                                        <span class="checkbox-icon">üìö</span>
                                        <span class="checkbox-text">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="goal-health" name="goals" value="health">
                                    <label for="goal-health" class="checkbox-label">
                                        <span class="checkbox-icon">üåø</span>
                                        <span class="checkbox-text">–ó–¥–æ—Ä–æ–≤—å–µ</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="goal-organization" name="goals" value="organization">
                                    <label for="goal-organization" class="checkbox-label">
                                        <span class="checkbox-icon">üè†</span>
                                        <span class="checkbox-text">–ë—ã—Ç</span>
                                    </label>
                                </div>
                                <div class="checkbox-card">
                                    <input type="checkbox" id="goal-relationships" name="goals" value="relationships">
                                    <label for="goal-relationships" class="checkbox-label">
                                        <span class="checkbox-icon">üíù</span>
                                        <span class="checkbox-text">–û—Ç–Ω–æ—à–µ–Ω–∏—è</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="terms">
                            –ù–∞–∂–∏–º–∞—è ¬´–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è¬ª, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å <a href="/terms.html" class="link">–ø—Ä–∞–≤–∏–ª–∞–º–∏ —Å–µ—Ä–≤–∏—Å–∞</a>.
                        </div>
                        <button type="submit" class="auth-button">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                        
                        <!-- –ë–ª–æ–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞ -->
                        <div id="resend-email" style="display: none; margin-top: 15px; text-align: center;">
                            <p class="small muted">–ù–µ –ø—Ä–∏—à–ª–æ –ø–∏—Å—å–º–æ?</p>
                            <button type="button" id="resend-btn" class="link" style="font-size: 14px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –µ—â—ë —Ä–∞–∑</button>
                        </div>
                    </form>
                    <div id="signup-msg" class="notice" style="display:none"></div>
                </div>
            </div>
        </section>

<!-- –°–µ–∫—Ü–∏—è —Å—Ñ–µ—Ä –∂–∏–∑–Ω–∏ -->
<section class="features-section">
    <h2 class="raleway-heading">–°—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏ –≤ RUNLI</h2>
    <div class="features-grid">
        <div class="feature-card">
            <h3>–ó–¥–æ—Ä–æ–≤—å–µ</h3>
        </div>
        <div class="feature-card">
            <h3>–§–∏–Ω–∞–Ω—Å—ã</h3>
        </div>
        <div class="feature-card">
            <h3>–°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ</h3>
        </div>
        <div class="feature-card">
            <h3>–î–æ–º–∞—à–Ω–∏–π —É—é—Ç</h3>
        </div>
    </div>
</section>
    </main>

    <footer>
        <p>&copy; 2025 RUNLI. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </footer>

    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        document.querySelectorAll('.auth-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
                
                tab.classList.add('active');
                const tabName = tab.getAttribute('data-tab');
                document.getElementById(`${tabName}-form`).classList.add('active');
            });
        });

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
        document.getElementById('forgot-password').addEventListener('click', async () => {
            const email = document.getElementById('signin-email').value.trim();
            if (!email) {
                alert('–í–≤–µ–¥–∏—Ç–µ email –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è');
                return;
            }

            try {
                const { error } = await supabase.auth.resetPasswordForEmail(email, {
                    redirectTo: `${window.location.origin}/reset-password.html`
                });
                
                if (error) throw error;
                alert('–°—Å—ã–ª–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –ø–æ—á—Ç—É üíå');
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            }
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∞–≤–∞—Ç–∞—Ä–∞
        document.getElementById('register-avatar').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('avatar-preview');
                    preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                }
                reader.readAsDataURL(file);
            }
        });

        // –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        document.getElementById('register-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('register-email').value.trim();
            const password = document.getElementById('register-password').value;
            const fullName = document.getElementById('register-name').value.trim();
            const age = document.getElementById('register-age').value;
            const avatarFile = document.getElementById('register-avatar').files[0];
            
            const activities = Array.from(document.querySelectorAll('input[name="activity"]:checked'))
                                  .map(checkbox => checkbox.value);
            
            const goals = Array.from(document.querySelectorAll('input[name="goals"]:checked'))
                              .map(checkbox => checkbox.value);

            if (password.length < 6) {
                setMessage('signup-msg', '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –º–∏–Ω–∏–º—É–º –∏–∑ 6 —Å–∏–º–≤–æ–ª–æ–≤ üîê');
                return;
            }

            if (!fullName) {
                setMessage('signup-msg', '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à–µ –∏–º—è');
                return;
            }

            try {
                const redirectTo = `${window.location.origin}/index.html?confirmed=1`;
                const { data, error } = await supabase.auth.signUp({
                    email,
                    password
                }, { redirectTo });

                if (error) throw error;

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–≤–∞—Ç–∞—Ä –µ—Å–ª–∏ –µ—Å—Ç—å
                let avatarUrl = null;
                if (avatarFile) {
                    const fileName = `avatars/${data.user.id}/${Date.now()}_${avatarFile.name}`;
                    const { data: uploadData, error: uploadError } = await supabase.storage
                        .from('avatars')
                        .upload(fileName, avatarFile);
                    
                    if (!uploadError) {
                        const { data: urlData } = supabase.storage
                            .from('avatars')
                            .getPublicUrl(fileName);
                        avatarUrl = urlData.publicUrl;
                    }
                }

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
                if (data.user) {
                    await supabase.from('profiles').upsert({
                        user_id: data.user.id,
                        full_name: fullName,
                        age: age || null,
                        avatar_url: avatarUrl,
                        activity: activities.length > 0 ? activities : null,
                        goals: goals.length > 0 ? goals : null,
                        updated_at: new Date().toISOString()
                    });
                }

                setMessage('signup-msg', 
                    `–ö–≤–µ—Å—Ç –ø–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ—á—Ç–∏ –ø—Ä–æ–π–¥–µ–Ω! –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–±—Ä–∞—Ç—å –∫–ª—é—á-—Å—Å—ã–ª–∫—É –∏–∑ –≤–∞—à–µ–≥–æ –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å—É–Ω–¥—É–∫–∞!`, 
                    true
                );
                
                document.getElementById('resend-email').style.display = 'block';
                
            } catch (error) {
                setMessage('signup-msg', '–û—à–∏–±–∫–∞: ' + error.message);
            }
        });

        // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å—å–º–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        document.getElementById('resend-btn').addEventListener('click', async () => {
            const email = document.getElementById('register-email').value.trim();
            if (!email) {
                setMessage('signup-msg', '–í–≤–µ–¥–∏—Ç–µ email –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞');
                return;
            }

            try {
                const { error } = await supabase.auth.resend({
                    type: 'signup',
                    email: email
                });
                
                if (error) throw error;
                setMessage('signup-msg', '–ü–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É (–∏ –ø–∞–ø–∫—É "–°–ø–∞–º")', true);
            } catch (error) {
                setMessage('signup-msg', '–û—à–∏–±–∫–∞: ' + error.message);
            }
        });

        // –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        document.getElementById('signin-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('signin-email').value.trim();
            const password = document.getElementById('signin-password').value;

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email,
                    password
                });

                if (error) throw error;

                const { data: { user } } = await supabase.auth.getUser();
                let message = '–û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∞—à —É—é—Ç–Ω—ã–π —É–≥–æ–ª–æ–∫...';
                
                if (user && !user.email_confirmed_at) {
                    message += '\n\nüí° –ü–æ—á—Ç–∞ –µ—â—ë –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞–∫–∫–∞—É–Ω—Ç–æ–º, –Ω–æ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å';
                }

                setMessage('signin-msg', message, true);
                
                setTimeout(() => {
                    window.location.href = '/dashboard.html';
                }, 1000);
            } catch (error) {
                setMessage('signin-msg', '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message);
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
        function setMessage(elementId, text, isSuccess = false) {
            const element = document.getElementById(elementId);
            element.textContent = text;
            element.style.display = 'block';
            element.className = `notice ${isSuccess ? 'success' : ''}`;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('confirmed') === '1') {
            setMessage('signin-msg', '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ! –í–∞—à–µ –ª–∏—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç–æ', true);
        }
    </script>
</body>
</html>
